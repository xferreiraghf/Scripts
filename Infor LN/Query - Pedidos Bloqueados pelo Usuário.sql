/* Pedidos bloqueados pelo Usuário */

select a.t$orno as "Ordem",
       a.t$refa as "Pedido",
       a.t$ofbp as "Parceiro",
       b.t$nama as "Razão social",
       g.t$fovn$l as "Entidade fiscal",
       g.t$cste as "Estado",
       TO_CHAR(a.t$odat, 'DD/MM/YYYY') AS "Data ordem",
       TO_CHAR(a.t$ddat, 'DD/MM/YYYY') AS "Data entrega",
       d.t$emno$C as "Bloqueado por",
       TO_CHAR(d.t$date$c, 'DD/MM/YYYY') AS "Data bloqueio",
       f.t$repr$c as "Cod.Representante",
       e.t$dsca as "Representante",
       
       decode(a.t$stov$C,
              1,
              'Analise Comercial',
              2,
              'Analise Financeira',
              3,
              'Analise ADM Vendas/Comprometimento',
              4,
              'Expedição',
              5,
              'Expedição em Atendimento',
              6,
              'Faturamento',
              7,
              'Faturado',
              8,
              'Faturado Parcial',
              9,
              'Cancelado',
              10,
              'Devolvido') as "Situação da Ordem",
       
       decode(b.t$prst,
              2,
              'Ativo',
              3,
              'Inativo',
              4,
              'Suspenso',
              5,
              'Cancelado') as "Status PN",
       
       decode(b.t$ctit,
              001,
              'Cliente',
              002,
              'Fornecedor',
              003,
              'Representante',
              004,
              'Transportadora',
              005,
              'Preposto',
              006,
              'Facção',
              007,
              'Empresa do Grupo',
              008,
              'Prospect',
              009,
              'Funcionário',
              010,
              'Exterior',
              011,
              'Consumidor',
              012,
              'Cliente/Fornecedor Normal') as "Título",
       
       decode(c.t$cbrn,
              
              '11001',
              'VAREJO MULTIMARCA',
              '11002',
              'MULTIMARCA QUALIFICADO',
              '11003',
              'ATACADO (X)',
              '11004',
              'REDE ESTRUTURADA',
              '11005',
              'REDE DE VALOR',
              '11006',
              'MONOMARCA BRANDILI',
              '11007',
              'E-COMMERCE (X)',
              '11008',
              'EXPORTAÇÃO',
              '11009',
              'FRANQUIA',
              '11010',
              'DISTRIBUIDOR',
              '11011',
              'HIPERMERCADO',
              '11012',
              'REPRESENTANTE',
              '11013',
              'OUTLET',
              '11014',
              'BRANDILI MAIS',
              '11015',
              'GOs - GRANDES ORGANIZAÇÕES',
              '11016',
              'PESSOA FÍSICA',
              '11017',
              'VENDEDOR AUTÔNOMO',
              '11018',
              'KEY ACCOUNT',
              '20000',
              'IMPORTAÇÃO',
              '22000',
              'ATACADO',
              '22001',
              'REDE',
              '22002',
              'SUPERMERCADO',
              '22003',
              'E-COMMERCE',
              '22004',
              'VAR.MULT.- EMPREENDA BRANDILI',
              '22005',
              'VAR.MULT.- LOJA INFANTIL A/B/C',
              '22006',
              'VAR.MULT.- LOJA INFANTIL C/D/E',
              '22007',
              'VAR.MULT.- LOJA FAMÍLIA A/B/C',
              '22008',
              'VAR.MULT.- LOJA FAMÍLIA C/D/E',
              '22009',
              'MAGAZINE',
              '22010',
              'PORTA A PORTA',
              '50000',
              'SEM INFORMAÇÃO',
              '60000',
              'FORNECEDOR',
              '600010',
              'P.L.',
              '70023',
              'PROSPECT',
              '70024',
              'COMERCIAL EXPORTADORA',
              '70025',
              'PREPOSTO',
              '70026',
              'FILIAL BRANDILI',
              '70027',
              'FORNECEDOR/CLIENTE') as "Segmento",
       
       /* Regional */
       decode(f.t$repr$c,
              'R00035',
              'Sul',
              'R00158',
              'Sul',
              'R00159',
              'Sul',
              'R00038',
              'Sul',
              'R00126',
              'Sul',
              'R00036',
              'Sul',
              'R00032',
              'Sul',
              'R00129',
              'Sul',
              'R00203',
              'Sul',
              'R00201',
              'Sul',
              'R00040',
              'Sul',
              'R00072',
              'Sul',
              'R00041',
              'Sul',
              'R00195',
              'Sul',
              'R00165',
              'Sul',
              'R00048',
              'Sul',
              'R00229',
              'Sul',
              'R00219',
              'Sul',
              'R00149',
              'Centro',
              'R00223',
              'Centro',
              'R00050',
              'Centro',
              'R00225',
              'Centro',
              'R00226',
              'Centro',
              'R00198',
              'Centro',
              'R00077',
              'Centro',
              'R00199',
              'Centro',
              'R00197',
              'Centro',
              'R00215',
              'Centro',
              'R00205',
              'Centro',
              'R00210',
              'Centro',
              'R00211',
              'Centro',
              'R00087',
              'Centro',
              'R00163',
              'Centro',
              'R00216',
              'Centro',
              'R00214',
              'Centro',
              'R00103',
              'Centro',
              'R00051',
              'Norte/Nordeste',
              'R00092',
              'Norte/Nordeste',
              'R00133',
              'Norte/Nordeste',
              'R00193',
              'Norte/Nordeste',
              'R00140',
              'Norte/Nordeste',
              'R00012',
              'Norte/Nordeste',
              'R00120',
              'Norte/Nordeste',
              'R00206',
              'Norte/Nordeste',
              'R00123',
              'Norte/Nordeste',
              'R00013',
              'Norte/Nordeste',
              'R00227',
              'Norte/Nordeste',
              'R00213',
              'Norte/Nordeste',
              'R00209',
              'Norte/Nordeste',
              'R00078',
              'São Paulo',
              'R00118',
              'São Paulo',
              'R00208',
              'São Paulo',
              'R00003',
              'São Paulo',
              'R00202',
              'São Paulo',
              'R00095',
              'São Paulo',
              'R00188',
              'São Paulo',
              'R00192',
              'São Paulo',
              'R00134',
              'São Paulo',
              'R00112',
              'São Paulo',
              'R00191',
              'São Paulo',
              'R00186',
              'São Paulo',
              'R00224',
              'São Paulo',
              'R00111',
              'São Paulo',
              'R00204',
              'Brás',
              'R00060',
              'Brás',
              'R00058',
              'Sul',
              'R00060',
              'São Paulo',
              'R00061',
              'Centro Norte',
              'R00062',
              'Nordeste',
              'R00064',
              'Exportação',
              'R00145',
              'SP Interior',
              'R00059',
              'Sudeste',
              'R00184',
              'Key Account',
              'R00079',
              'Key Account',
              'R00063',
              'Direto',
              'R99999',
              'Direto',
              'R00127',
              'Direto',
              'R99996',
              'Direto',
              'R00196',
              'PL',
              'R00056',
              'Exportação',
              'R00136',
              'Exportação',
              ' ',
              'Sem informação') as "Regional",
       
       decode(f.t$repr$c,
              'R00035',
              'Vivian Cristine Grassmann',
              'R00158',
              'Vivian Cristine Grassmann',
              'R00159',
              'Vivian Cristine Grassmann',
              'R00038',
              'Vivian Cristine Grassmann',
              'R00126',
              'Vivian Cristine Grassmann',
              'R00036',
              'Vivian Cristine Grassmann',
              'R00032',
              'Vivian Cristine Grassmann',
              'R00129',
              'Vivian Cristine Grassmann',
              'R00203',
              'Vivian Cristine Grassmann',
              'R00201',
              'Vivian Cristine Grassmann',
              'R00040',
              'Vivian Cristine Grassmann',
              'R00072',
              'Vivian Cristine Grassmann',
              'R00041',
              'Vivian Cristine Grassmann',
              'R00195',
              'Vivian Cristine Grassmann',
              'R00165',
              'Vivian Cristine Grassmann',
              'R00048',
              'Vivian Cristine Grassmann',
              'R00229',
              'Vivian Cristine Grassmann',
              'R00219',
              'Vivian Cristine Grassmann',
              'R00225',
              'Vivian Cristine Grassmann',
              'R00226',
              'Vivian Cristine Grassmann',
              'R00198',
              'Vivian Cristine Grassmann',
              'R00077',
              'Vivian Cristine Grassmann',
              'R00199',
              'Vivian Cristine Grassmann',
              'R00197',
              'Vivian Cristine Grassmann',
              'R00215',
              'Vivian Cristine Grassmann',
              'R00205',
              'Vivian Cristine Grassmann',
              'R00210',
              'Vivian Cristine Grassmann',
              'R00211',
              'Vivian Cristine Grassmann',
              'R00149',
              'Irla Caroline Silva dos Anjos',
              'R00223',
              'Irla Caroline Silva dos Anjos',
              'R00050',
              'Irla Caroline Silva dos Anjos',
              'R00051',
              'Irla Caroline Silva dos Anjos',
              'R00092',
              'Irla Caroline Silva dos Anjos',
              'R00133',
              'Irla Caroline Silva dos Anjos',
              'R00193',
              'Irla Caroline Silva dos Anjos',
              'R00140',
              'Irla Caroline Silva dos Anjos',
              'R00012',
              'Irla Caroline Silva dos Anjos',
              'R00120',
              'Irla Caroline Silva dos Anjos',
              'R00206',
              'Irla Caroline Silva dos Anjos',
              'R00123',
              'Irla Caroline Silva dos Anjos',
              'R00013',
              'Irla Caroline Silva dos Anjos',
              'R00227',
              'Irla Caroline Silva dos Anjos',
              'R00213',
              'Irla Caroline Silva dos Anjos',
              'R00209',
              'Irla Caroline Silva dos Anjos',
              'R00060',
              'Paula Tomelin') as "Atendimento Financeiro"

  from igrppr.ttdsls400001 a, /* Ordens de vendas */
       igrppr.ttccom100001 b, /* Parceiros de negócios */
       igrppr.ttccom110001 c, /* Parceiros de negócios clientes */
       igrppr.ttdzbr025001 d, /* Histórico Movimentação da Ordem de Venda */
       igrppr.ttcmcs065001 e, /* Departamentos */
       igrppr.ttdzbr003001 f, /* Cadastro de Atendimento aos Clientes */
       igrppr.ttccom130001 g /* Endereços */

 where a.t$ofbp = b.t$bpid
   and b.t$bpid = c.t$ofbp
   and c.t$cadr = b.t$cadr
   and b.t$cadr = g.t$cadr
   and b.t$nama = g.t$nama
   and a.t$orno = d.t$orno$c
   and b.t$bpid = f.t$bpid$c
   and e.t$cwoc = f.t$repr$c
   and f.t$ativ$c like '1'
   and f.t$styp$C like '002'
   and d.t$emno$C = 'b12392' /* Usuário (Puxando apenas pelo usuário definido) */
   and b.t$ctit like '001' /* Título (Puxando apenas clientes) */
   and b.t$prst in ('4', '5') /* Status do Cliente (Puxando Suspensos e Cancelados) */
   and a.t$stov$C in ('2', '3', '4', '5', '6') /* Situação do Pedido (Puxando somente pedidos em aberto) */
   and substr(a.t$orno, 1, 1) in ('1', '2', '8', '3', '5', '6', '4') /* Incial do pedido (Puxando pedidos apenas com as iniciais citadas) */
   and d.t$date$c BETWEEN (SELECT SYSDATE FROM DUAL) - 7 AND
       (SELECT SYSDATE FROM DUAL) - 1 /*Busca semana anterior*/

/* By Ferreira - Atualizado: 14/08/2023 | Atualização na busca de novos representantes  / Atendimento Financeiro */
