/* QUERY - Clientes Brandili */

Select
a.t$bpid as "Parceiro",
a.t$ctit as "Título",
a.t$nama as "Razão social",
c.t$ftyp$l as "Tipo entidade",
c.t$fovn$l as "Entidade",
c.t$dsca as "Cidade",
c.t$ccty as "País",
c.t$cste as "Estado",
c.t$ddd1$c as "DDD",
c.t$telp as "Telefone",
c.t$info as "E-mail",
c.t$enfe$l as "E-mail NFE",
a.t$lmus as "Cod. última alteração",
d.t$name as "Alterado por",
TO_CHAR(a.t$lmdt, 'DD/MM/YYYY') AS "Data última alteração",
b.t$cbrn as "Cod.Segmento",
a.t$code$c as "Cod.Status",

CASE  
   WHEN c.t$ccit IN (3505401,3506359,3509254,3509908,3513504,3514809,3518701,3520301,3520426,3522109,3523305,3524600,3526100,3529906,3531100,3536208,3537206,3537602,3541000,
                     3542602,3548500, 3551009,3551801,3550308,3513801,3515707,3523107,3529401,3539806,3543303,3544103,3547809,3548708,3548807,3552502,3505708,3509007,3509205,
                     3510609,3513009,3515004,3515103,3516309,3516408,3522208,3522505,3525003,3526209,3528502,3534401,3539103,3547304,3549953,3552809,3556453,3518800) THEN 'REGIONAL SUDESTE' 

   WHEN c.t$ccit IN (3501004,3501707,3503000,3503208,3505609,3505906,3506706,3506805,3507407,3507803,3508207,3508702,3509403,3510104,3510807,3510906,3513108,3513207,3513702,3513900,3514007,
3514304,3514601,3515608,3516200,3516853,3517703,3518602,3518859,3519303,3520103,3521309,3522000,3522703,3523701,3523800,3524105,3524303,3525102,3525409,3527603,3529302,
3529708,3530508,3531308,3531902,3532058,3532900,3533601,3534302,3536307,3537008,3539301,3539509,3540200,3540705,3540903,3542701,3542909,3543105,3543402,3543600,3543709,
3544905,3545605,3546256,3546306,3546504,3546900,3547502,3547601,3547908,3548906,3549409,3549508,3549706,3550803,3550902,3551405,3551504,3551702,3552700,3553104,3553203,
3553302,3553609,3553658,3553708,3554409,3554755,3556404,3556800,3556909,3502507,3503158,3503505,3503901,3504909,3506607,3508504,3508603,3509700,3509957,3510500,3513405,
3513603,3518305,3518404,3520202,3520400,3524402,3524907,3526308,3526605,3527207,3530607,3531704,3532306,3535606,3538006,3538501,3540754,3541901,3542305,3544301,3545001,
3546009,3546801,3548203,3548609,3549607,3549904,3550001,3550704,3552007,3554102,3554805,3555406,3500303,3500402,3500501,3500600,3501608,3501905,3502002,3503307,3503802,
3507605,3507902,3510401,3511706,3512209,3512407,3512704,3512803,3515152,3515186,3557303,3519055,3521101,3521408,3522604,3523602,3524709,3526704,3526902,3527009,3530706,
3530805,3530904,3531209,3532009,3533403,3536505,3536802,3537107,3538204,3538709,3542107,3543907,3544004,3545159,3545803,3546207,3546702,3547007,3548005,3548104,3549102,
3550407,3551603,3552106,3552403,3554706,3554953,3556354,3504107,3507100,3508405,3509502,3509601,3514908,3519071,3520509,3523404,3523909,3524006,3525201,3525508,3525904,
3527306,3531803,3532405,3538600,3545209,3556206,3556503,3556701,3500105,3500808,3501103,3501301,3502101,3502408,3502804,3503356,3504008,3504404,3505104,3505807,3506201,
3506409,3506508,3507704,3507753,3508900,3509106,3510005,3511003,3511904,3512506,3513306,3514403,3515129,3515301,3515350,3515806,3516002,3516101,3516507,3517000,3517109,
3517208,3517307,3517802,3518206,3519006,3519204,3519907,3520608,3520806,3521606,3523008,3525607,3526001,3526506,3527405,3527702,3527900,3528700,3528809,3528908,3529203,
3530102,3530201,3531605,3532108,3532157,3532207,3533106,3533205,3534104,3534609,3534807,3534906,3535309,3535408,3535507,3536000,3536406,3537156,3537305,3537701,3538303,
3539202,3539707,3540002,3540853,3541208,3541307,3541406,3541505,3541604,3541703,3541802,3542008,3542206,3542404,3543238,3543808,3544251,3544400,3544707,3545100,3545506,
3547106,3547700,3548302,3548401,3549300,3552908,3553906,3553955,3554300,3555000,3555109,3556305,3500204,3500907,3501202,3501806,3502606,3503703,3503950,3504206,3504602,
3504800,3505500,3506102,3508108,3509304,3510708,3511102,3511201,3511300,3512001,3512100,3512902,3513850,3514205,3514924,3514957,3515202,3515509,3515905,3516804,3516903,
3517406,3517505,3517901,3518008,3518909,3519402,3519600,3519808,3520442,3520707,3521150,3521507,3521903,3524204,3524501,3524808,3525706,3527256,3528106,3528205,3528304,
3528858,3529104,3529500,3529609,3529658,3530003,3530300,3530409,3531001,3531407,3531506,3532504,3532603,3532702,3532801,3532843,3532868,3533007,3533304,3533254,3533502,
3533908,3534005,3534203,3534757,3535002,3535101,3535200,3535705,3535903,3536257,3536604,3536901,3537404,3538105,3539004,3539608,3539905,3540259,3540309,3540408,3540804,
3544202,3544509,3544806,3545704,3546108,3546603,3547403,3547650,3547205,3548054,3549003,3549201,3549250,3549805,3551306,3551900,3552304,3552551,3552601,3553401,3554904,
3555208,3555307,3555356,3555604,3555703,3555802,3556008,3556107,3556958,3557105,3557154,3500550,3500709,3501400,3501509,3502309,3503406,3503604,3504305,3504701,3505203,
3505302,3506003,3506300,3506904,3507308,3507456,3507506,3508306,3508801,3509809,3510153,3557204,3514106,3514502,3514700,3515194,3515657,3516606,3516705,3518107,3519105,
3519253,3519501,3520004,3520905,3522901,3523503,3525300,3525805,3526803,3527108,3527504,3527801,3528007,3528601,3529005,3529807,3533700,3533809,3534500,3534708,3536109,
3536570,3536703,3538907,3539400,3540101,3541059,3541109,3542503,3543204,3544608,3545407,3546405,3550100,3550506,3555505,3555901,3556602,3500758,3501152,3502200,3502705,
3502754,3502903,3503109,3504503,3505005,3505351,3507001,3507159,3508009,3509452,3510203,3510302,3511409,3511508,3511607,3512308,3512605,3515400,3517604,3518503,3519709,
3521002,3521200,3521705,3521804,3522158,3522307,3522406,3522653,3522802,3523206,3525854,3526407,3528403,3532827,3535804,3537503,3537800,3537909,3538808,3540507,3540606,
3541653,3542800,3543006,3543253,3543501,3545308,3550209,3550605,3551108,3551207,3552205,3553005,3553500,3553807,3553856,3554003,3554201,3554508,3554607,3554656,3557006) THEN 'REGIONAL SP INTERIOR'
    
   WHEN  c.t$cste IN ('SC','PR','RS','MS') THEN 'REGIONAL SUL'
   WHEN  c.t$cste IN ('RO','AC','AM','RR','DF','TO','PA','MT','GO','AP','MG') THEN 'REGIONAL CENTRO NORTE'
   WHEN  c.t$cste IN ('PI','BA','AL','SE','CE','RN','PE','MA','PB') THEN 'REGIONAL NORDESTE'
   WHEN  c.t$cste IN ('ES') THEN 'REGIONAL SP INTERIOR'
   WHEN  c.t$cste IN ('RJ') THEN 'REGIONAL SUDESTE'
    
    ELSE null
     END AS "REGIONAL",

decode(a.t$prst,

  2, 'Ativo',
  3, 'Inativo',
  4, 'Suspenso',
  5, 'Cancelado'
  ) as "Status",

CASE
                  WHEN a.t$code$c = 1 AND a.t$prst = 2 THEN
                   'CLIENTE ATIVO PRÓXIMO (X)'
                
                  WHEN a.t$code$c = 1 AND a.t$prst = 5 THEN
                   'CLIENTE FECHOU A LOJA (X)'
                
                  WHEN a.t$code$c = 2 AND a.t$prst = 2 THEN
                   'NAO VAI COMPRAR'
                
                  WHEN a.t$code$c = 2 AND a.t$prst = 5 THEN
                   'CLIENTE MUDOU DE RAMO. (X)'
                
                  WHEN a.t$code$c = 4 AND a.t$prst = 2 THEN
                   'INADIMPLENTE'
                
                  WHEN a.t$code$c = 4 AND a.t$prst = 5 THEN
                   'CLIENTE PROXIMO (X)'
                
                  WHEN a.t$code$c = 5 AND a.t$prst = 2 THEN
                   'PEDIDO MINIMO MUITO ALTO'
                
                  WHEN a.t$code$c = 5 AND a.t$prst = 5 THEN
                   'INAPTO NA RECEITA FEDERAL.'
                
                  WHEN a.t$code$c = 6 AND a.t$prst = 2 THEN
                   'NÃO POSSUI LOJA FÍSICA'
                
                  WHEN a.t$code$c = 6 AND a.t$prst = 5 THEN
                   'BAIXADO NA RECEITA FEDERAL.'
                
                  WHEN a.t$code$c = 9 AND a.t$prst = 2 THEN
                   'PROBLEMAS FINANCEIROS'
                
                  WHEN a.t$code$c = 9 AND a.t$prst = 5 THEN
                   'DESLIGOU-SE DA EMPRESA. (X)'
                
                  WHEN a.t$code$c = 41 AND a.t$prst = 2 THEN
                   '180 DIAS SEM COMPRA'
                
                  WHEN a.t$code$c = 41 AND a.t$prst = 4 THEN
                   'FINANCEIRO (RESTRICAO DE CREDITO).'
                
                  WHEN a.t$code$c = 2 THEN
                   'NAO VAI COMPRAR'
                  WHEN a.t$code$c = 2 THEN
                   'CLIENTE MUDOU DE RAMO (X)'
                  WHEN a.t$code$c = 3 THEN
                   'QUERIA INFORMAÇAO'
                  WHEN a.t$code$c = 4 THEN
                   'INADIMPLENTE'
                  WHEN a.t$code$c = 4 THEN
                   'CLIENTE PROXIMO (X)'
                  WHEN a.t$code$c = 5 THEN
                   'PEDIDO MINIMO MUITO ALTO'
                  WHEN a.t$code$c = 5 THEN
                   'INAPTO NA RECEITA FEDERAL'
                  WHEN a.t$code$c = 6 THEN
                   'NÃO POSSUI LOJA FÍSICA'
                  WHEN a.t$code$c = 6 THEN
                   'BAIXADO NA RECEITA FEDERAL'
                  WHEN a.t$code$c = 7 THEN
                   'SUSPENSO NA RECEITA FEDERAL.'
                  WHEN a.t$code$c = 9 THEN
                   'PROBLEMAS FINANCEIROS'
                  WHEN a.t$code$c = 9 THEN
                   'DESLIGOU-SE DA EMPRESA (X)'
                  WHEN a.t$code$c = 10 THEN
                   'NAO CONVEM COMO CLIENTE (X)'
                  WHEN a.t$code$c = 11 THEN
                   'SEM RETORNO'
                  WHEN a.t$code$c = 11 THEN
                   'ATIVO'
                  WHEN a.t$code$c = 12 THEN
                   'CNPJ DUPLICADO.'
                  WHEN a.t$code$c = 13 THEN
                   'INATIVO (NÃO ENVIAR P/ TELEVENDAS)'
                  WHEN a.t$code$c = 15 THEN
                   'ATIVO EXCETO TELEVENDAS'
                  WHEN a.t$code$c = 20 THEN
                   '2 COLEÇÕES SEM COMPRA'
                  WHEN a.t$code$c = 21 THEN
                   '3 COLEÇÕES SEM COMPRA'
                  WHEN a.t$code$c = 25 THEN
                   'SOLICITADO PELO COMERCIAL (X)'
                  WHEN a.t$code$c = 30 THEN
                   'FALTA DE INF. COMERCIAIS (X)'
                  WHEN a.t$code$c = 35 THEN
                   'SOLICITADO PELO REPRESENTANTE'
                  WHEN a.t$code$c = 37 THEN
                   'SEM FATURAMENTO A MAIS DE 365 DIAS'
                  WHEN a.t$code$c = 38 THEN
                   'OUTROS'
                  WHEN a.t$code$c = 39 THEN
                   '270 DIAS SEM COMPRA'
                  WHEN a.t$code$c = 40 THEN
                   'FINANCEIRO (ANTECIPADO NAO PAGO)'
                  WHEN a.t$code$c = 41 THEN
                   '180 DIAS SEM COMPRA'
                  WHEN a.t$code$c = 41 THEN
                   'FINANCEIRO (RESTRICAO DE CREDITO)'
                  WHEN a.t$code$c = 43 THEN
                   'CADASTRO (SINTEGRA, NAO HABILITADO)'
                  WHEN a.t$code$c = 44 THEN
                   'CADASTRO (SUFRAMA, NAO HABILITADO)'
                  WHEN a.t$code$c = 45 THEN
                   'COMERCIAL (DESACORDO COML)'
                  WHEN a.t$code$c = 46 THEN
                   'COMERCIAL (DEVOLUCAO DE MERCADORIA, SEM MOTIVO)'
                  WHEN a.t$code$c = 49 THEN
                   'CADASTRO (ENDEREÇO DIVERGENTE=RF)'
                  WHEN a.t$code$c = 50 THEN
                   'CADASTRO (CNPJ NÃO OK PARA GERAÇÃO DO  PIN)'
                  WHEN a.t$code$c = 51 THEN
                   'NÃO EFETUOU PAGAMENTO IMPOSTO'
                  WHEN a.t$code$c = 52 THEN
                   'CLIENTE INADIMPLENTE'
                  WHEN a.t$code$c = 55 THEN
                   'FECHOU LOJA - VERIFICADO/TELEVENDAS'
                  WHEN a.t$code$c = 60 THEN
                   'MUDOU DE RAMO - VERIFICADO/TELEVENDAS'
                  WHEN a.t$code$c = 62 THEN
                   'NÃO EFETUOU PAGAMENTO PEDIDO ANTECIPADO'
                  WHEN a.t$code$c = 70 THEN
                   'PERDAS FINANCEIRAS (X)'
                  WHEN a.t$code$c = 72 THEN
                   'COMPRA POR OUTRO CNPJ'
                  WHEN a.t$code$c = 80 THEN
                   'DESISTIU DO PEDIDO'
                  WHEN a.t$code$c = 82 THEN
                   'NÃO DEVE SER ABORDADO PELO TELEVENDAS'
                  WHEN a.t$code$c = 91 THEN
                   'NÃO TRABALHA MAIS COMA MARCA (X)'
                  WHEN a.t$code$c = 92 THEN
                   'STATUS NÃO DEFINIDO (X)'
                  WHEN a.t$code$c = 93 THEN
                   'DESTINATÁRIO BLOQUEADO NA UF'
                  WHEN a.t$code$c = 97 THEN
                   'ATIVO PELO TELEVENDAS'
                  WHEN a.t$code$c = 98 THEN
                   'ATIVO (CONTAS A RECEBER)'
                  WHEN a.t$code$c = 99 THEN
                   'ATIVO'
                  WHEN a.t$code$c = 8 THEN
                   'CLIENTE FECHOU A LOJA.'
                  WHEN a.t$code$c = 14 THEN
                   'CLIENTE MUDOU DE RAMO.'
                  WHEN a.t$code$c = 16 THEN
                   'CLIENTE PROXIMO'
                  WHEN a.t$code$c = 17 THEN
                   'DESLIGOU-SE DA EMPRESA.'
                  WHEN a.t$code$c = 18 THEN
                   'NAO CONVEM COMO CLIENTE.'
                  WHEN a.t$code$c = 19 THEN
                   'INAPTO NA RECEITA FEDERAL.'
                  WHEN a.t$code$c = 22 THEN
                   'SOLICITADO PELO COMERCIAL.'
                  WHEN a.t$code$c = 23 THEN
                   'FALTA DE INF. COMERCIAIS.'
                  WHEN a.t$code$c = 24 THEN
                   'SUSPENSO NA RECEITA FEDERAL.'
                  WHEN a.t$code$c = 31 THEN
                   'PERDAS FINANCEIRAS'
                  WHEN a.t$code$c = 33 THEN
                   'NÃO TRABALHA MAIS COM A MARCA'
                  WHEN a.t$code$c = 34 THEN
                   'STATUS NÃO DEFINIDO'
                
                  ELSE
                   null
                END AS "Motivo Status",

decode (b.t$cbrn, 
11001, 'VAREJO MULTIMARCA',
11002, 'MULTIMARCA QUALIFICADO',
11003, 'ATACADO (X)',
11004, 'REDE ESTRUTURADA',
11005, 'REDE DE VALOR',
11006, 'MONOMARCA BRANDILI',
11007, 'E-COMMERCE (X)',
11008, 'EXPORTAÇÃO',
11009, 'FRANQUIA',
11010, 'DISTRIBUIDOR',
11011, 'HIPERMERCADO',
11012, 'REPRESENTANTE',
11013, 'OUTLET',
11014, 'BRANDILI MAIS',
11015, 'GOs - GRANDES ORGANIZAÇÕES',
11016, 'PESSOA FÍSICA',
11017, 'VENDEDOR AUTÔNOMO',
11018, 'KEYACCOUNT',
20000, 'IMPORTAÇÃO',
22000, 'ATACADO',
22001, 'REDE',
22002, 'SUPERMERCADO',
22003, 'E-COMMERCE',
22004, 'VAR.MULT.- EMPREENDA BRANDILI',
22005, 'VAR.MULT.- LOJA INFANTIL A/B/C',
22006, 'VAR.MULT.- LOJA INFANTIL C/D/E',
22007, 'VAR.MULT.- LOJA FAMÍLIA A/B/C',
22008, 'VAR.MULT.- LOJA FAMÍLIA C/D/E',
22009, 'MAGAZINE',
22010, 'PORTA A PORTA',
50000, 'SEM INFORMAÇÃO',
60000, 'FORNECEDOR',
600010, 'P.L.',
70000, 'FACÇÃO',
70001, 'FACÇÃO - NOVO GERFAC',
70020, 'FACÇÃO - BORDADO',
70021, 'FACÇÃO - ESTAMPA',
70022, 'FACÇÃO - LAVANDERIA',
70023, 'PROSPECT',
70024, 'COMERCIAL EXPORTADORA',
70025, 'PREPOSTO',
70026, 'FILIAL BRANDILI',
' ',   'FALTA INFORMACAO'
) as "Segmento"

from
igrppr.ttccom100001 a, /* Parceiros de negócios */
igrppr.ttccom110001 b, /* Parceiros de negócios clientes */
igrppr.ttccom130001 c, /* Endereço */
igrppr.tttaad200000 d  /* Funcionários */

where a.t$bpid = b.t$ofbp
and a.t$cadr = b.t$cadr
and a.t$nama = c.t$nama
and a.t$cadr = c.t$cadr
and a.t$lmus = d.t$user
and a.t$ctit = '001'
and c.t$ccty = 'BRA'
and b.t$cbrn in
(
'11001', /*VAREJO MULTIMARCA*/
'11003', /*ATACADO (X)*/
'11004', /*REDE ESTRUTURADA*/
'11007', /*E-COMMERCE (X)*/
'11008', /*EXPORTAÇÃO*/
'11016', /*PESSOA FÍSICA*/
'11017', /*VENDEDOR AUTÔNOMO*/
'11018', /*KEY ACCOUNT*/
'22000', /*ATACADO*/
'22001', /*REDE*/
'22002', /*SUPERMERCADO*/
'22003', /*E-COMMERCE*/
'22004', /*VAR.MULT.- EMPREENDA BRANDILI*/
'22005', /*VAR.MULT.- LOJA INFANTIL A/B/C*/
'22006', /*VAR.MULT.- LOJA INFANTIL C/D/E*/
'22007', /*VAR.MULT.- LOJA FAMÍLIA A/B/C*/
'22008', /*VAR.MULT.- LOJA FAMÍLIA C/D/E*/
'22009', /*MAGAZINE*/
'22010', /*PORTA A PORTA*/
'50000' /*SEM INFORMAÇÃO*/
)

order by a.t$bpid

/* By Ferreira  - Atualizado: 
15/08/2023 | Atualizado os motivos de status / Formato da data.
20/02/2023 | Alteração realizada nas condições de status, foi gerado novos status para os PNs*/